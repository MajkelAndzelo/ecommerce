<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<h1>Processing Order...</h1>

<p>Please wait while we process your order.</p>

<script>
  $(document).ready(function() {
    // check for the order status every 5 seconds
    var intervalId = setInterval(function() {
      $.ajax({
        url: '<%= order_status_path %>',
        type: 'GET',
        dataType: 'json',
        success: function(data) {
          if (data.order_created) {
            clearInterval(intervalId); // stop the interval
            window.location.href = '<%= order_path(@order) %>'; // redirect to the order details page
          }
        },
        error: function(jqXHR, textStatus, errorThrown) {
          console.log(textStatus, errorThrown);
        }
      });
    }, 5000);
  });
</script>